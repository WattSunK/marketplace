
<!-- Row 1: System Status â€” first column only -->
<section class="ws-admin-section">
  <h2 class="ws-admin-title">System Status</h2>
  <div class="sys3-grid">
    <div class="sys-card" id="sys-status-card">
      <div id="statusContainer">
        <div class="status-card"><span class="status-label">Backend API:</span> Checking...</div>
        <div class="status-card"><span class="status-label">Cloudflare Tunnel:</span> Checking...</div>
      </div>
      <div class="timestamp" id="timestamp">Loading...</div>
    </div>
    <div class="sys-card sys-card--ghost" aria-hidden="true"></div>
    <div class="sys-card sys-card--ghost" aria-hidden="true"></div>
  </div>
</section>

<!-- Row 2: Three existing cards -->
<section class="ws-admin-section">
  <div class="sys3-grid">
    <div class="sys-card">
      <div class="sys-tabs">
        <button class="tab active">Active orders</button>
        <button class="tab">Past Orders</button>
      </div>
      <div class="sys-row"><strong>Placed</strong>&nbsp; Mon, 19 Jan, 11:32 AM</div>
      <div class="sys-row"><strong>Chez Panisse.</strong>&nbsp; <strong>KSh 252.95</strong></div>
      <div class="sys-row">Order ID: 1585922175843</div>
      <div class="sys-btns">
        <button class="sys-btn">TRACK ORDER</button>
        <button class="sys-btn">CANCEL ORDER</button>
        <button class="sys-btn">HELP</button>
      </div>
      <div class="sys-linkbar">
        <a href="#">View 1 item ordered &gt;</a>
        <a href="#">View Address And Billing Details â–¾</a>
      </div>
    </div>

    <div class="sys-card">
      <h3>Items <button class="sys-btn" style="margin-left:auto">EDIT</button></h3>
      <div class="sys-row"><strong>Active Item</strong></div>
      <div class="sys-row">SKU: J23456450.50</div>
      <div class="sys-row">STOCK: 9</div>
      <div class="sys-row" style="margin-top:10px;"><strong>John Doe</strong></div>
      <div class="sys-row">Phone: +254 123456789</div>
      <div class="sys-row">Email: john@email.com</div>
    </div>

    <div class="sys-card">
      <h3>Dispatch <button class="sys-btn" style="margin-left:auto">TRACK</button></h3>
      <div class="sys-row"><strong>Delivery dispatch</strong></div>
      <div class="sys-row">Order #123456</div>
      <div class="sys-row">Delivery #80</div>
      <div class="sys-row">Order #123456 - Out for delivery</div>
      <div class="sys-row" style="margin-top:10px;"><strong>Status</strong></div>
      <div class="sys-row">Out for delivery</div>
    </div>
  </div>
</section>

<style>
  /* keep layout but hide ghost cards so the first row doesn't span full width */
  .sys-card.sys-card--ghost{
    background: transparent!important;
    border: none!important;
    box-shadow: none!important;
    min-height: 0!important;
  }
</style>

<script>
  function fetchWithTimeout(url, opts = {}, ms = 8000) {
    const controller = new AbortController();
    const id = setTimeout(() => controller.abort(), ms);
    return fetch(url, { ...opts, signal: controller.signal }).finally(() => clearTimeout(id));
  }
  async function checkStatus() {
    const box = document.getElementById('statusContainer');
    const ts = document.getElementById('timestamp');
    if (!box) return;
    box.innerHTML = '';
    let backend = 'Checkingâ€¦', tunnel = 'Checkingâ€¦';
    try {
      const r = await fetchWithTimeout('/api/health', {}, 8000);
      backend = r.ok ? 'ðŸŸ¢ OK' : 'ðŸ”´ DOWN (HTTP ' + r.status + ')';
    } catch(e) { backend = 'ðŸ”´ DOWN (network error)'; }
    try {
      const r2 = await fetchWithTimeout('/api/tunnel', {}, 8000);
      tunnel = r2.ok ? 'ðŸŸ¢ Connected' : 'ðŸ”´ Disconnected (HTTP ' + r2.status + ')';
    } catch(e) { tunnel = 'ðŸ”´ Disconnected (network error)'; }
    box.innerHTML += '<div class="status-card ' + (backend.includes('ðŸ”´')?'red':'') + '"><span class="status-label">Backend API:</span> ' + backend + '</div>';
    box.innerHTML += '<div class="status-card ' + (tunnel.includes('ðŸ”´')?'red':'') + '"><span class="status-label">Cloudflare Tunnel:</span> ' + tunnel + '</div>';
    if (ts) ts.textContent = 'Last checked: ' + new Date().toLocaleTimeString() + ' â€“ auto-refreshes every 30s';
  }
  checkStatus(); setInterval(checkStatus, 30000);
</script>
